<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate tree statistics across all modules — calculateTreeStats • CroCoNet</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate tree statistics across all modules — calculateTreeStats"><meta name="description" content="Calculates various tree statistics (total tree length, total within-species diversity, diversity within each species, monophyleticity for each species and branch length between each species and all others) for all modules/jackknifed module versions based on a list of tree representations."><meta property="og:description" content="Calculates various tree statistics (total tree length, total within-species diversity, diversity within each species, monophyleticity for each species and branch length between each species and all others) for all modules/jackknifed module versions based on a list of tree representations."><meta property="og:image" content="https://hellmann-lab.github.io/CroCoNet/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CroCoNet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/CroCoNet.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Hellmann-Lab/CroCoNet/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate tree statistics across all modules</h1>
      <small class="dont-index">Source: <a href="https://github.com/Hellmann-Lab/CroCoNet/blob/main/R/calculateTreeStats.R" class="external-link"><code>R/calculateTreeStats.R</code></a></small>
      <div class="d-none name"><code>calculateTreeStats.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates various tree statistics (total tree length, total within-species diversity, diversity within each species, monophyleticity for each species and branch length between each species and all others) for all modules/jackknifed module versions based on a list of tree representations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculateTreeStats</span><span class="op">(</span><span class="va">tree_list</span>, n_cores <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tree-list">tree_list<a class="anchor" aria-label="anchor" href="#arg-tree-list"></a></dt>
<dd><p>A named list of <code>phylo</code> objects containing the tree representations of all modules/jackknifed module versions, with the tips of the trees corresponding to clones. All trees are expected to have a component <code>species</code> that specifies which species each tip belongs to. The trees can also contain a component <code>info</code> that stores metadata of the module/jackknifed module version in a data frame format.</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>Integer, the number of cores (default: 1).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame of tree statistics with the following columns:</p><dl><dt>regulator</dt>
<dd><p>Character, transcriptional regulator.</p></dd>

<dt>module_size</dt>
<dd><p>Module size, the number of target genes assigned to a regulator (only present if the column is also present in the component <code>info</code> of the trees).</p></dd>

<dt>type</dt>
<dd><p>Character, module type (orig = original or jk = jackknifed, only present if the input trees were reconstructed with jackknifing).</p></dd>

<dt>id</dt>
<dd><p>Character, the unique ID of the module version (format: nameOfRegulator_jk_nameOfGeneRemoved in case of module type 'jk' and nameOfRegulator_orig in case of module type 'orig', only present if the input trees were reconstructed with jackknifing).</p></dd>

<dt>gene_removed</dt>
<dd><p>Character, the name of the gene removed by jackknifing (NA in case of module type 'orig', only present if the input trees were reconstructed with jackknifing).</p></dd>

<dt>within_species_diversity</dt>
<dd><p>Numeric, the sum of the species-wise diversities.</p></dd>

<dt>total_tree_length</dt>
<dd><p>Numeric, the total length of all branches in the tree.</p></dd>

<dt>{{species}}_diversity</dt>
<dd><p>Numeric, as many columns as there are species, each of them containing the the total length of the branches connecting the clones of the given species.</p></dd>

<dt>{{species}}_monophyl</dt>
<dd><p>Logical, as many columns as there are species, each of them indicating whether the tree is monophyletic for the clones of the given species.</p></dd>

<dt>{{species}}_to_other_branch_length</dt>
<dd><p>Numeric, as many columns as there are species, each of them containing the length of the internal branch that connects the subtree of the clones belonging to the given species and the subtree of all other clones. NA if the tree is not monophyletic for the clones of the given species.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>As part of the CroCoNet approach, pairwise module preservation scores are calculated between clones, both within and across species (see <code><a href="calculatePresStats.html">calculatePresStats</a></code>) and neighbor-joining trees are reconstructed based on these preservation scores per module (see <code><a href="convertPresToDist.html">convertPresToDist</a></code> and <code><a href="reconstructTrees.html">reconstructTrees</a></code>). The tips of the resulting tree represent the clones and the branch lengths represent the dissimilarity of module connectivity patterns between the networks of 2 clones.</p>
<p>Various useful statistics can be defined based on these module trees:</p><ul><li><p>Total tree length: The total length of all branches in the tree; measures module variability both within and across species.</p></li>
<li><p>Diversity of a species: The total length of the branches connecting the clones of the given species to each other; measures module variability within this particular species.</p></li>
<li><p>Within-species diversity: The sum of the diversity values across all species; measures module variability within species in general.</p></li>
<li><p>Monophyleticity of a species: Indicates whether the tree is monophyletic for the clones of the given species. Only if a module tree is monophyletic for a species of interest can the module be tested for divergence between this species and all others.</p></li>
<li><p>Species-to-other branch length: The length of the internal branch that connects the subtree of the clones belonging to the given species and the subtree of all other clones; measures module variability between this species and all others. Undefined if the tree is not monophyletic for the species of interest.</p></li>
</ul><p>In the later steps of the pipeline, these tree-based statistics can be used to 1) identify modules that are conserved, diverged overall or diverged between a species and all others (see <code><a href="findConservedDivergedModules.html">findConservedDivergedModules</a></code>), and 2) pinpoint individual target genes within these modules that contribute the most to the conservation/divergence (see <code><a href="findConservedDivergedTargets.html">findConservedDivergedTargets</a></code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">tree_stats_jk</span> <span class="op">&lt;-</span> <span class="fu">calculateTreeStats</span><span class="op">(</span><span class="va">trees_jk</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anita Térmeg.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

