<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate module eigengenes — calculateEigengenes • CroCoNet</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate module eigengenes — calculateEigengenes"><meta name="description" content="Calculates the module eigengene for each input module."><meta property="og:description" content="Calculates the module eigengene for each input module."><meta property="og:image" content="https://hellmann-lab.github.io/CroCoNet/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CroCoNet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/CroCoNet.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Hellmann-Lab/CroCoNet/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate module eigengenes</h1>
      <small class="dont-index">Source: <a href="https://github.com/Hellmann-Lab/CroCoNet/blob/main/R/calculateEigengenes.R" class="external-link"><code>R/calculateEigengenes.R</code></a></small>
      <div class="d-none name"><code>calculateEigengenes.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the module eigengene for each input module.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculateEigengenes</span><span class="op">(</span></span>
<span>  <span class="va">pruned_modules</span>,</span>
<span>  <span class="va">sce</span>,</span>
<span>  direction_of_regulation <span class="op">=</span> <span class="st">"+_only"</span>,</span>
<span>  module_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">pruned_modules</span><span class="op">$</span><span class="va">regulator</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  per_species <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pseudotime_column <span class="op">=</span> <span class="st">"pseudotime"</span>,</span>
<span>  cell_type_column <span class="op">=</span> <span class="st">"cell_type"</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">1L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pruned-modules">pruned_modules<a class="anchor" aria-label="anchor" href="#arg-pruned-modules"></a></dt>
<dd><p>Data frame of the pruned modules, required columns:</p><dl><dt>regulator</dt>
<dd><p>Character, transcriptional regulator.</p></dd>

<dt>target</dt>
<dd><p>Character, target gene of the transcriptional regulator (member of the regulator's pruned module).</p></dd>

<dt>direction</dt>
<dd><p>Character specifying the direction of interaction between the regulator and the target, either "+" or "-" (only required if <code>direction_of_regulation</code> is set to "+_only" or "+-_separately").</p></dd>


</dl></dd>


<dt id="arg-sce">sce<a class="anchor" aria-label="anchor" href="#arg-sce"></a></dt>
<dd><p><code>SingleCellExperiment</code> object containing the expression data (logcounts and metadata) for all network genes. Required metadata columns:</p><dl><dt>species</dt>
<dd><p>Character, the name of the species.</p></dd>

<dt>{{pseudotime_column}}</dt>
<dd><p>Numeric, inferred pseudotime (optional).</p></dd>

<dt>{{cell_type_column}}</dt>
<dd><p>Character, cell type annotation (optional).</p></dd>


</dl></dd>


<dt id="arg-direction-of-regulation">direction_of_regulation<a class="anchor" aria-label="anchor" href="#arg-direction-of-regulation"></a></dt>
<dd><p>Character specifying how positively and negatively regulated targets of the same transcriptional regulator should be treated, one of "+_only", "+-_separately", "all_together". If "+_only", the eigengene is calculated only for the positively regulated targets, the negatively regulated targets are removed. If "+-_separately", the eigengene is calculated separately for the positively and negatively regulated targets. If "all_together", the eigengene is calculated for all targets, irrespective of the direction of regulation.</p></dd>


<dt id="arg-module-names">module_names<a class="anchor" aria-label="anchor" href="#arg-module-names"></a></dt>
<dd><p>Character vector, the names of the modules for which the eigengenes should be calculated (default: all unique names in the column <code>regulator</code> of <code>pruned_modules</code>).</p></dd>


<dt id="arg-per-species">per_species<a class="anchor" aria-label="anchor" href="#arg-per-species"></a></dt>
<dd><p>Logical, if FALSE (default), the eigengenes are calculated across all cells, if TRUE, the eigengenes are calculated per species.</p></dd>


<dt id="arg-pseudotime-column">pseudotime_column<a class="anchor" aria-label="anchor" href="#arg-pseudotime-column"></a></dt>
<dd><p>Character, the name of the pseudotime column in the metadata of <code>sce</code> (default: "pseudotime", if there is no pseudotime column, it should be set to NULL).</p></dd>


<dt id="arg-cell-type-column">cell_type_column<a class="anchor" aria-label="anchor" href="#arg-cell-type-column"></a></dt>
<dd><p>Character, the name of the cell type annotation column in the metadata of <code>sce</code> (default: "cell_type", if there is no cell type column, it should be set to NULL).</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>Integer, the number of cores (default: 1).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame of eigengenes with the following columns:</p><dl><dt>cell</dt>
<dd><p>Character, the cell barcode.</p></dd>

<dt>species</dt>
<dd><p>Character, the name of the species.</p></dd>

<dt>{{pseudotime_column}}</dt>
<dd><p>Numeric, inferred pseudotime (only present if <code>pseudotime_column</code> is not NULL).</p></dd>

<dt>{{cell_type_column}}</dt>
<dd><p>Character, cell type annotation (only present if <code>cell_type_column</code> is not NULL).</p></dd>

<dt>module</dt>
<dd><p>Character, transcriptional regulator and in case the eigengene was calculated for the positively or negatively regulated targets only, the direction of interaction (format: nameOfRegulator(+) or nameOfRegulator(-)).</p></dd>

<dt>eigengene</dt>
<dd><p>Numeric, the eigengene (i.e. the first principal component of the scaled and centered logcounts) of the module. In case <code>per_species</code> is TRUE, it is calculated for each species separately.</p></dd>

<dt>mean_expr</dt>
<dd><p>Numeric, the mean of the scaled and centered logcounts across all genes in the module.</p></dd>

<dt>regulator_expr</dt>
<dd><p>Numeric, the scaled and centered logcounts of the regulator.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>A concept adapted from WGCNA, the eigengene summarizes the expression profile of an entire module, and it is calculated as the first principal component of the module expression data. Effectively, it is a weighted mean of the individual genes' expression profiles.</p>
<p>As the first step, the logcounts are subsetted to keep only module member genes and the resulting count matrix is scaled and centered per gene. Next, singular value decomposition is performed on the scaled and centered count matrix using <code><a href="https://rdrr.io/r/base/svd.html" class="external-link">svd</a></code>, with <code>nu</code> = 1 and <code>nv</code> = 1 (only 1 left and 1 right singular vector computed). The right singular vector is taken as the eigengene. Finally, this eigengene is aligned along the average expression of the module: if the correlation of the two vectors is negative, the eigengene is negated, if the correlation is positive, the eigengene is kept as it is.</p>
<p>If a module contains both activated and repressed targets of the transcriptional regulator, calculating the eigengene (or any other summary expression profiles) across both directions of regulation does not make biological sense and leads to the dilution of signal. It makes more sense to calculate the eigengene either for the activated targets only (<code>direction_of_regulation</code> = "+_only") or for the activated and repressed targets separately (<code>direction_of_regulation</code> = "+-_separately"). In these cases, the <code>module</code> column of the output will specify not only the name of the transcriptional regulator but also the direction of regulation (format: nameOfRegulator(+) or nameOfRegulator(-)). If an eigengene across all targets is desired irrespective of the direction of regulation, <code>direction_of_regulation</code> should be set to "all_together".</p>
<p>If the aim is to compare the eigengenes across species, it is recommended to calculate the eigengenes per species by setting <code>per_species</code> to TRUE. In this case, the scaling, centering and SVD is performed for each species separately.</p>
<p>If the user plans to plot the eigengene along pseudotime and/or cell types, the corresponding columns of the <code>sce</code> object can be specified by the arguments of <code>pseudotime_column</code> and <code>cell_type_column</code>, and then the pseudotime and cell type information of each cell will be added to the output.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Zhang, B., &amp; Horvath, S. (2005). A general framework for weighted gene co-expression network analysis. Statistical Applications in Genetics and Molecular Biology, 4, 17-60. https://doi.org/10.2202/1544-6115.1128</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">eigengenes</span> <span class="op">&lt;-</span> <span class="fu">calculateEigengenes</span><span class="op">(</span><span class="va">pruned_modules</span>, <span class="va">sce</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">eigengenes_per_dir</span> <span class="op">&lt;-</span> <span class="fu">calculateEigengenes</span><span class="op">(</span><span class="va">pruned_modules</span>, <span class="va">sce</span>, <span class="st">"+-_separately"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">eigengenes_per_species</span> <span class="op">&lt;-</span> <span class="fu">calculateEigengenes</span><span class="op">(</span><span class="va">pruned_modules</span>, <span class="va">sce</span>, per_species <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anita Térmeg.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

