<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot cross-species VS within-species preservation statistics per species pair — plotPresStats • CroCoNet</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot cross-species VS within-species preservation statistics per species pair — plotPresStats"><meta name="description" content="Plots the cross-species VS within-species preservation scores for all possible species pairs. If a statistic is a good measure of module preservation, the within-species scores are expected to be higher than the cross-species scores for all species pairs, and the difference is expected to increase with increasing phylogenetic distance between the two species compared."><meta property="og:description" content="Plots the cross-species VS within-species preservation scores for all possible species pairs. If a statistic is a good measure of module preservation, the within-species scores are expected to be higher than the cross-species scores for all species pairs, and the difference is expected to increase with increasing phylogenetic distance between the two species compared."><meta property="og:image" content="https://hellmann-lab.github.io/CroCoNet/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CroCoNet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/CroCoNet.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Hellmann-Lab/CroCoNet/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot cross-species VS within-species preservation statistics per species pair</h1>
      <small class="dont-index">Source: <a href="https://github.com/Hellmann-Lab/CroCoNet/blob/main/R/plotPresStats.R" class="external-link"><code>R/plotPresStats.R</code></a></small>
      <div class="d-none name"><code>plotPresStats.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plots the cross-species VS within-species preservation scores for all possible species pairs. If a statistic is a good measure of module preservation, the within-species scores are expected to be higher than the cross-species scores for all species pairs, and the difference is expected to increase with increasing phylogenetic distance between the two species compared.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotPresStats</span><span class="op">(</span></span>
<span>  <span class="va">pres_stats</span>,</span>
<span>  random_pres_stats <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">stats</span>,</span>
<span>  colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  font_size <span class="op">=</span> <span class="fl">14</span>,</span>
<span>  point_size <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  point_alpha <span class="op">=</span> <span class="fl">0.7</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pres-stats">pres_stats<a class="anchor" aria-label="anchor" href="#arg-pres-stats"></a></dt>
<dd><p>Data frame of the preservation statistics for the actual (pruned) modules. Required columns:</p><dl><dt>regulator</dt>
<dd><p>Character, transcriptional regulator.</p></dd>

<dt>module_size</dt>
<dd><p>Integer, the numer of target genes assigned to a regulator (only needed if the data points are desired to be colored by module size).</p></dd>

<dt>clone1, clone2</dt>
<dd><p>Character, the names of the clones compared.</p></dd>

<dt>species1, species2</dt>
<dd><p>Character, the names of the species <code>clone1</code> and <code>clone2</code> belongs to, respectively.</p></dd>

<dt>{{nameOfStat}}</dt>
<dd><p>Numeric, one or more columns containing the preservation statistic of interest per module and clone pair.</p></dd>


</dl></dd>


<dt id="arg-random-pres-stats">random_pres_stats<a class="anchor" aria-label="anchor" href="#arg-random-pres-stats"></a></dt>
<dd><p>Data frame of the preservation statistics for the random modules (optional). If provided, the following columns are required:</p><dl><dt>regulator</dt>
<dd><p>Character, transcriptional regulator.</p></dd>

<dt>clone1, clone2</dt>
<dd><p>The names of the clones compared.</p></dd>

<dt>species1, species2</dt>
<dd><p>The names of the species <code>clone1</code> and <code>clone2</code> belongs to, respectively.</p></dd>

<dt>{{nameOfStat}}</dt>
<dd><p>Numeric, one or more columns containing the preservation statistic(s) of interest per module and clone pair.</p></dd>


</dl></dd>


<dt id="arg-stats">stats<a class="anchor" aria-label="anchor" href="#arg-stats"></a></dt>
<dd><p>Character or character vector, the name(s) of the column(s) containing the statistics of interest.</p></dd>


<dt id="arg-colors">colors<a class="anchor" aria-label="anchor" href="#arg-colors"></a></dt>
<dd><p>Character vector, either the colors to visualize the module sizes (if only <code>pres_stats</code> is provided), or the colors to visualize the actual and random modules (if both <code>pres_stats</code> and <code>random_pres_stats</code> are provided). In the first case, the vector can contain any number of colors that will be passed on to and converted into a continuous scale by <code>scale_color_gradientn</code>. In the second case, the vector should contain 2 colors for the actual and random modules.</p></dd>


<dt id="arg-font-size">font_size<a class="anchor" aria-label="anchor" href="#arg-font-size"></a></dt>
<dd><p>Numeric, font size (default: 14).</p></dd>


<dt id="arg-point-size">point_size<a class="anchor" aria-label="anchor" href="#arg-point-size"></a></dt>
<dd><p>Numeric, the size of the points (default: 0.3).</p></dd>


<dt id="arg-point-alpha">point_alpha<a class="anchor" aria-label="anchor" href="#arg-point-alpha"></a></dt>
<dd><p>Numeric, the opacity of the points (default: 0.7).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A scatterplot as a <code>ggplot</code> object showing the cross-species VS within-species preservation scores per species pair for all pruned modules and if provided, all random modules.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>As part of the CroCoNet approach, pairwise module preservation scores are calculated between clones, both within and across species (see <code><a href="calculatePresStats.html">calculatePresStats</a></code>) to gain information about the cross-species differences but also about the within-species diversity of the modules. These correlation-based preservation statistics quantify how well the module topology is preserved between the networks of two clones.</p>
<p>For each possible speciesA-speciesB pair in the data, the function first subsets the within-species scores for speciesA, the within-species scores for speciesB and the cross-species scores between speciesA and speciesB, then calculates the mean of the within-species scores as well as the mean of the cross-species scores per module.</p>
<p>For example, if there are 2 species, human and gorilla, with 3 human clones (<em>h1</em>, <em>h2</em> and <em>h3</em>), and 2 gorilla clones (<em>g1</em> and <em>g2</em>), for a single module there will be 3 preservation scores within the human clones (\(p_{h1-h2}\), \(p_{h1-h3}\) and \(p_{h2-h3}\)), 1 preservation score within the gorilla clones (\(p_{g1-g2}\)) and 6 preservation scores across the 2 species (\(p_{h1-g1}\), \(p_{h1-g2}\), \(p_{h2-g1}\), \(p_{h2-g2}\), \(p_{h3-g1}\) and \(p_{h3-g2}\)). For this module and the human-gorilla species pair, the summarized within-species score will then be the mean of the 4 within-species scores (\(mean(p_{h1-h2}, p_{h1-h3}, p_{h2-h3}, p_{g1-g2})\)) and the cross-species score will be the mean of the 6 cross-species scores (\(mean(p_{h1-g1}, p_{h1-g2}, p_{h2-g1}, p_{h2-g2}, p_{h3-g1}, p_{h3-g2})\)).</p>
<p>After calculating the summarized scores for all modules and species pairs, the cross-species scores are plotted against the within-species scores faceted by species pair. The within-species scores are expected to be higher than the cross-species scores, thus the data points are expected to fall under the diagonal in all facets. However, the more phylogenetically distant two species are, the bigger deviation we expect from the diagonal.</p>
<p>If <code>random_pres_stats</code> is provided, the actual and the random modules are plotted together, shown in 2 different colors. The actual modules are expected to better preserved than the random modules (especially within species), therefore the 2 sets of modules are expected to cluster separately on the plot, with the actual modules located towards the higher (within-species) scores.</p>
<p>If <code>random_pres_stats</code> is not provided, only the actual modules in <code>pres_stats</code> are shown on the plot. In this case, if the column "module_size" is present in <code>pres_stats</code>, the data points are colored by module size.</p>
<p>If several different statistics are input, these will be shown as the rows of the faceted plot. When it comes to choosing the best statistic, it is recommended to take the one that follows the most the expected trends in terms of within-species VS cross-species scores, phylogeny, and actual VS random modules.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other functions to plot preservation statistics:
<code><a href="plotPresStatDistributions.html">plotPresStatDistributions</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">plotPresStats</span><span class="op">(</span><span class="va">pres_stats</span>, stats <span class="op">=</span> <span class="st">"cor_kIM"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotPresStats-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anita Térmeg.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

