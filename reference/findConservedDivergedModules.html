<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Find conserved and diverged modules — findConservedDivergedModules • CroCoNet</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Find conserved and diverged modules — findConservedDivergedModules"><meta name="description" content="Finds conserved and diverged network modules based on a (weighted) linear model between the total tree length and within-species diversity (in case the focus of interest is conservation and overall divergence) or between the species-to-other branch length and diversity of a species (in case the focus of interest is species-specific divergence) of the module trees. Modules are considered conserved or diverged if they fall outside the 95% prediction interval of the regression line."><meta property="og:description" content="Finds conserved and diverged network modules based on a (weighted) linear model between the total tree length and within-species diversity (in case the focus of interest is conservation and overall divergence) or between the species-to-other branch length and diversity of a species (in case the focus of interest is species-specific divergence) of the module trees. Modules are considered conserved or diverged if they fall outside the 95% prediction interval of the regression line."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CroCoNet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/CroCoNet.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Hellmann-Lab/CroCoNet/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Find conserved and diverged modules</h1>
      <small class="dont-index">Source: <a href="https://github.com/Hellmann-Lab/CroCoNet/blob/main/R/findConservedDivergedModules.R" class="external-link"><code>R/findConservedDivergedModules.R</code></a></small>
      <div class="d-none name"><code>findConservedDivergedModules.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Finds conserved and diverged network modules based on a (weighted) linear model between the total tree length and within-species diversity (in case the focus of interest is conservation and overall divergence) or between the species-to-other branch length and diversity of a species (in case the focus of interest is species-specific divergence) of the module trees. Modules are considered conserved or diverged if they fall outside the 95% prediction interval of the regression line.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">findConservedDivergedModules</span><span class="op">(</span><span class="va">tree_stats</span>, <span class="va">lm_tree_stats</span>, conf_level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tree-stats">tree_stats<a class="anchor" aria-label="anchor" href="#arg-tree-stats"></a></dt>
<dd><p>Data frame of the tree-based statistics for the pruned modules.</p>
<p>Columns required in case the focus of interest is conservation and overall divergence:</p><dl><dt>regulator</dt>
<dd><p>Character, transcriptional regulator.</p></dd>

<dt>module_size</dt>
<dd><p>Integer, the numer of target genes assigned to a regulator.</p></dd>

<dt>total_tree_length</dt>
<dd><p>Numeric, total tree length per module (typically the median across all jackknife versions of the module).</p></dd>

<dt>var_total_tree_length</dt>
<dd><p>Numeric, the variance of total tree lengths across all jackknifed versions of the module (optional, only needed for weighted regression).</p></dd>

<dt>lwr_total_tree_length</dt>
<dd><p>Numeric, the lower bound of the confidence interval of the total tree length calculated based on the jackknifed versions of the module (optional, only needed for plotting error bars later on).</p></dd>

<dt>upr_total_tree_length</dt>
<dd><p>Numeric, the upper bound of the confidence interval of the total tree length calculated based on the jackknifed versions of the module (optional, only needed for plotting error bars later on).</p></dd>

<dt>within_species_diversity</dt>
<dd><p>Numeric, within-species diveristy per module (typically the median across all jackknife versions of the module).</p></dd>

<dt>lwr_within_species_diversity</dt>
<dd><p>Numeric, the lower bound of the confidence interval of the within-species diversity calculated based on the jackknifed versions of the module (optional, only needed for plotting error bars later on).</p></dd>

<dt>upr_within_species_diversity</dt>
<dd><p>Numeric, the upper bound of the confidence interval of the within-species diversity calculated based on the jackknifed versions of the module (optional, only needed for plotting error bars later on).</p></dd>


</dl><p>Columns required in case the focus of interest is species-specific divergence:</p><dl><dt>regulator</dt>
<dd><p>Character, transcriptional regulator.</p></dd>

<dt>module_size</dt>
<dd><p>Integer, the numer of target genes assigned to a regulator.</p></dd>

<dt>{{species}}_to_other_branch_length</dt>
<dd><p>Numeric, the species-to-other branch length per module (typically the median across all jackknife versions of the module).</p></dd>

<dt>var_{{species}}_to_other_branch_length</dt>
<dd><p>Numeric, the variance of the species-to-other branch lengths across all jackknifed versions of the module (optional, only needed for weighted regression).</p></dd>

<dt>lwr_{{species}}_to_other_branch_length</dt>
<dd><p>Numeric, the lower bound of the confidence interval of the species-to-other branch length calculated based on the jackknifed versions of the module (optional, only needed for plotting error bars later on).</p></dd>

<dt>upr_{{species}}_to_other_branch_length</dt>
<dd><p>Numeric, the upper bound of the confidence interval of the species-to-other branch length calculated based on the jackknifed versions of the module (optional, only needed for plotting error bars later on).</p></dd>

<dt>{{species}}_diversity</dt>
<dd><p>Numeric, the diveristy of the species of interest per module (typically the median across all jackknife versions of the module)</p></dd>

<dt>lwr_{{species}}_diversity</dt>
<dd><p>Numeric, the lower bound of the confidence interval of the species-specific diversity calculated based on the jackknifed versions of the module (optional, only needed for plotting error bars later on).</p></dd>

<dt>upr_{{species}}_diversity</dt>
<dd><p>Numeric, the upper bound of the confidence interval of the species-specific diversity calculated based on the jackknifed versions of the module (optional, only needed for plotting error bars later on).</p></dd>


</dl></dd>


<dt id="arg-lm-tree-stats">lm_tree_stats<a class="anchor" aria-label="anchor" href="#arg-lm-tree-stats"></a></dt>
<dd><p>An object of class <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>, the (weighted) linear model between the total tree length and within-species diversity (in case the focus of interest is conservation and overall divergence) or between the species-to-other branch length and diversity of a species (in case the focus of interest is divergence between this particular species and all others).</p></dd>


<dt id="arg-conf-level">conf_level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>Confidence level of the prediction interval (default: 0.95).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Data frame of cross-species conservation measures per module. In addition to the relevant columns of the input "tree_stats", it contains 6 or 7 new columns:</p><dl><dt>focus</dt>
<dd><p>Character, the focus of interest in terms of cross-species conservation, either "overall" if the focus of interest is conservation and overall divergence, or the name of a species if the focus of interest is the divergence between this particular species and all others. Derived from the input linear model (<code>lm_tree_stats</code>).</p></dd>

<dt>fit</dt>
<dd><p>Numeric, the fitted total tree length/species-to_other branch length at the diversity value of the module.</p></dd>

<dt>lwr_fit</dt>
<dd><p>Numeric, the lower bound of the prediction interval of the fit.</p></dd>

<dt>upr_fit</dt>
<dd><p>Numeric, the upper bound of the prediction interval of the fit.</p></dd>

<dt>residual</dt>
<dd><p>Numeric, the residual of the module in the linear model. It is calculated as the difference between the observed and expected (fitted) total tree lengths/species-to-other branch lengths.</p></dd>

<dt>weight</dt>
<dd><p>Numeric, the weight of the module in the linear regression, inversely proportional to the variance of total tree lengths/species-to-other branch lengths (only if <code>weighted_lm</code> is set to TRUE).</p></dd>

<dt>t_score</dt>
<dd><p>Numeric, the t-score of the module. It is calculated as the residual normalized by the standard error of the total tree length/species-to-other branch length prediction at the given diversity value.</p></dd>

<dt>conservation</dt>
<dd><p>Character, "not_significant" if the module falls inside the prediction interval of the fit, "diverged" if a module has a higher total tree length/species-to-other branch length than the upper boundary of the prediction interval, and "conserved" if a module has a lower total tree length/species-to-other branch length than the lower boundary of the prediction interval.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>As part of the CroCoNet approach, pairwise module preservation scores are calculated between clones, both within and across species (see <code><a href="calculatePresStats.html">calculatePresStats</a></code>) and neighbor-joining trees are reconstructed based on these preservation scores per module (see <code><a href="convertPresToDist.html">convertPresToDist</a></code> and <code><a href="reconstructTrees.html">reconstructTrees</a></code>). The tips of the resulting tree represent the clones and the branch lengths represent the dissimilarity of module connectivity patterns between the networks of 2 clones.</p>
<p>Various useful statistics can be defined based on these trees (see also <code><a href="calculateTreeStats.html">calculateTreeStats</a></code>). The total tree length is the sum of all branch lengths in the tree and it measures module variability both within and across species. The diversity of a species is the sum of the branches connecting the clones of this species and it measures module variability within this particular species. The within-species diversity is the sum of the diversity values across all species and it measures module variability within species in general. The species-to-other branch length is defined as the length of the internal branch that connects the subtree of the clones from the species of interest to the subtree of all other clones and it measures module variability between this species and all others.</p>
<p>Overall divergence is best represented by the total tree length, while species-specific divergence is best represented by the species-to-other branch length, however the absolute values of these statistics in themselves are difficult to interpret. The diversity (either overall or for a particular species) can be used as an internal reference to determine whether the total tree length or the species-to-other branch length is larger/smaller than expected. The general relationship between total tree length and overall diversity or between the species-to-other branch length and the diversity of the species is captured via linear regression (see also <code><a href="fitTreeStatsLm.html">fitTreeStatsLm</a></code>). In term of cross-species conservation, the most interesting modules are then the outliers that do not follow the linear trend.</p>
<p>By analyzing the linear regression between total tree length and within-species diversity, we can single out modules that are conserved or diverged overall. The modules that fall far below the trend line are the most conserved ones: they have a lower total tree length than expected based on their within-species diversity, meaning that the species are not well-separated within the tree but rather mixed among each other. In contrast, the modules that are located far above the trend line are the most diverged ones: they have a higher total tree length than expected based on their within-species diversity, meaning that they thave long cross-species branches between one or more pairs of species.</p>
<p>By analyzing the linear regression between the species-to-other branch length and the diversity of a species, we can single out modules that are diverged between this particular species and all others: these are the modules that fall far above the trend line, i.e. that have a longer species-to-other branch than expected based on the diversity of the species. The modules that fall below the trend line are in this case not meaningful, since we can only call a module conserved, if it is conserved across all species.</p>
<p>For both types of analysis, we quantitatively define which modules are outliers, and thus conserved or diverged, by calculating the prediction interval of the linear fit. A module is considered diverged overall/in a species-specific manner if it has a higher total tree length/species-to-other branch length than the upper boundary of the prediction interval, while a module is considered conserved if it has a lower total tree length than the lower boundary of the prediction interval.</p>
<p>The degree of conservation/divergence can be further compared between the modules categorized as conserved/diverged. We recommend 2 measures: 1) the residual, which is the absolute difference between the observed and expected total tree lengths/species-to-other branch lengths at a given diversity value, and 2) the t-score, which is the residual normalized by the standard error of the total tree length/species-to-other branch length prediction at a given diversity value.</p>
<p>The linear regression can be weighted by the error of the data points. To gain this information, we can use jackknifing: each member gene of a module is removed and all statistics are recalculated (see the parameter <code>jackknife</code> in the function <code><a href="calculatePresStats.html">calculatePresStats</a></code>). The weight of a module in the regression is then defined to be inversely proportional to the variance of the dependent variable (total tree length/species-to-other branch length) across all jackknife versions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">module_conservation_overall</span> <span class="op">&lt;-</span> <span class="fu">findConservedDivergedModules</span><span class="op">(</span><span class="va">tree_stats</span>, <span class="va">lm_overall</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anita Térmeg.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

