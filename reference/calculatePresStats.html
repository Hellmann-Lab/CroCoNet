<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate preservation statistics — calculatePresStats • CroCoNet</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Calculate preservation statistics — calculatePresStats"><meta name="description" content="Calculates one or both of two preservation statistics - correlation of adjacencies (cor_adj) and correlation of intramodular connectivities (cor_kIM) - for all modules and replicate pairs with or without jackknifing."><meta property="og:description" content="Calculates one or both of two preservation statistics - correlation of adjacencies (cor_adj) and correlation of intramodular connectivities (cor_kIM) - for all modules and replicate pairs with or without jackknifing."><meta property="og:image" content="https://hellmann-lab.github.io/CroCoNet/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CroCoNet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/CroCoNet.html">Tutorial</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Documentation</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Hellmann-Lab/CroCoNet/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate preservation statistics</h1>
      <small class="dont-index">Source: <a href="https://github.com/Hellmann-Lab/CroCoNet/blob/main/R/calculatePresStats.R" class="external-link"><code>R/calculatePresStats.R</code></a></small>
      <div class="d-none name"><code>calculatePresStats.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates one or both of two preservation statistics - correlation of adjacencies (cor_adj) and correlation of intramodular connectivities (cor_kIM) - for all modules and replicate pairs with or without jackknifing.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculatePresStats</span><span class="op">(</span></span>
<span>  <span class="va">pruned_modules</span>,</span>
<span>  <span class="va">network_list</span>,</span>
<span>  stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cor_adj"</span>, <span class="st">"cor_kIM"</span><span class="op">)</span>,</span>
<span>  replicate2species <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  jackknife <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  signed <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  corr_method <span class="op">=</span> <span class="st">"spearman"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pruned-modules">pruned_modules<a class="anchor" aria-label="anchor" href="#arg-pruned-modules"></a></dt>
<dd><p>Data frame of pruned modules, required columns:</p><dl><dt>regulator</dt>
<dd><p>Character, transcriptional regulator.</p></dd>

<dt>target</dt>
<dd><p>Character, target gene of the transcriptional regulator (member of the regulator's pruned module).</p></dd>


</dl></dd>


<dt id="arg-network-list">network_list<a class="anchor" aria-label="anchor" href="#arg-network-list"></a></dt>
<dd><p>A named list of <code>igraph</code> objects containing the networks of all replicates.</p></dd>


<dt id="arg-stats">stats<a class="anchor" aria-label="anchor" href="#arg-stats"></a></dt>
<dd><p>Character or character vector specifying which preservation statistics to calculate (one or more of "cor_adj", "cor_kIM", default: c("cor_adj", "cor_kIM")).</p></dd>


<dt id="arg-replicate-species">replicate2species<a class="anchor" aria-label="anchor" href="#arg-replicate-species"></a></dt>
<dd><p>A data frame specifying which species each replicate belongs to, required columns:</p><dl><dt>replicate</dt>
<dd><p>Character, name of the replicate.</p></dd>

<dt>species</dt>
<dd><p>Character, name of the species.</p></dd>


</dl><p>If NULL (default), the output will contain no species information.</p></dd>


<dt id="arg-jackknife">jackknife<a class="anchor" aria-label="anchor" href="#arg-jackknife"></a></dt>
<dd><p>Logical specifying whether jackknifing should be performed or not (default: TRUE).</p></dd>


<dt id="arg-signed">signed<a class="anchor" aria-label="anchor" href="#arg-signed"></a></dt>
<dd><p>Logical indicating whether the networks in <code>network_list</code> are signed (default: FALSE, see also <code><a href="normalizeEdgeWeights.html">normalizeEdgeWeights</a></code>). If set to FALSE and <code>network_list</code> contains the edge attribute "direction", the edge weights in the network with direction "-" are negated for the calculation of "cor_adj".</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>Integer, the number of cores (default: 1).</p></dd>


<dt id="arg-corr-method">corr_method<a class="anchor" aria-label="anchor" href="#arg-corr-method"></a></dt>
<dd><p>Character, the method for the calculation of correlation, one of "spearman", "pearson", "kendall" (default: "spearman").</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Data frame of the preservation statistics with the following columns:</p><dl><dt>regulator</dt>
<dd><p>Character, transcriptional regulator.</p></dd>

<dt>module_size</dt>
<dd><p>Integer, the number of target genes assigned to a regulator (only present if the column is also present in <code>pruned_modules</code>).</p></dd>

<dt>type</dt>
<dd><p>Character, module type ("orig" = original or "jk" = jackknifed, only present if parameter <code>jackknife</code> is set to TRUE).</p></dd>

<dt>id</dt>
<dd><p>Character, the unique ID of the module version (format: nameOfRegulator_jk_nameOfGeneRemoved in case of module type "jk" and nameOfRegulator_orig in case of module type "orig", only present if parameter <code>jackknife</code> is set to TRUE).</p></dd>

<dt>gene_removed</dt>
<dd><p>Character, the name of the gene removed by jackknifing (NA in case of module type "orig", only present if parameter <code>jackknife</code> is set to TRUE).</p></dd>

<dt>replicate1, replicate2</dt>
<dd><p>Character, the names of the replicates compared.</p></dd>

<dt>species1, species2</dt>
<dd><p>Character, the names of the species <code>replicate1</code> and <code>replicate2</code> belong to, respectively (only present if <code>replicate2species</code> is not NULL).</p></dd>

<dt>{{nameOfStat}}</dt>
<dd><p>Numeric, one or more columns containing the preservation statistics specified by the parameter <code>stats</code>.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function calculates two preservation statistics adapted from WGCNA (cor_adj and cor_kIM) for each module and each replicate pair. Both statistics quantify how well the topology of a module is preserved between the networks of two replicates. The statistic cor_adj is the correlation of all edge weights within the module in the network of replicate1 VS in the network of replicate2, while the statistic cor_kIM is the correlation of the intramodular connectivities per module member gene in the network of replicate1 VS in the network of replicate2.</p>
<p>All statistics assume a joint module assignment (typically derived from the consensus network) but compare topological properties directly between the replicate-wise networks. In this approach, a module is always defined as the same set of genes, but the adjacencies/edge weights among these genes could differ from replicate to replicate; poorly preserved modules are expected to have many, while well-preserved modules are expected to have few such differences.</p>
<p>If <code>jackknife</code> is set to TRUE (the default), the function creates all possible jackknifed versions of each input module by removing each target gene assigned to that module (the regulator is never excluded), then it calculates the preservation statistics for all of these jackknifed module versions in addition to the original module. This way, a confidence interval can be calculated for each module and statistic (see <code><a href="summarizeJackknifeStats.html">summarizeJackknifeStats</a></code>). Later on in the pipeline, jackknifing can also provide information about which target genes within a conserved/diverged module are particularly responsible for the conservation/divergence (see <code><a href="findConservedDivergedTargets.html">findConservedDivergedTargets</a></code>). If jackknifing is not desired, please set <code>jackknife</code> to FALSE. This will also substantially reduce running times.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Langfelder, P., Luo, R., Oldham, M. C., &amp; Horvath, S. (2011). Is my network module preserved and reproducible? PLoS Computational Biology, 7(1), 1001057.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">pres_stats_jk</span> <span class="op">&lt;-</span> <span class="fu">calculatePresStats</span><span class="op">(</span><span class="va">pruned_modules</span>, <span class="va">network_list</span>, <span class="st">"cor_kIM"</span>, <span class="va">replicate2species</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anita Térmeg.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

