<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit (weighted) linear model between tree-based statistics — fitTreeStatsLm • CroCoNet</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit (weighted) linear model between tree-based statistics — fitTreeStatsLm"><meta name="description" content="Fits a (weighted) linear model between the total tree length and within-species diversity (in case the focus of interest is conservation and overall divergence) or between the species-to-other branch length and the diversity of a species (in case the focus of interest is the species-specific divergence)."><meta property="og:description" content="Fits a (weighted) linear model between the total tree length and within-species diversity (in case the focus of interest is conservation and overall divergence) or between the species-to-other branch length and the diversity of a species (in case the focus of interest is the species-specific divergence)."><meta property="og:image" content="https://hellmann-lab.github.io/CroCoNet/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CroCoNet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/CroCoNet.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Hellmann-Lab/CroCoNet/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fit (weighted) linear model between tree-based statistics</h1>
      <small class="dont-index">Source: <a href="https://github.com/Hellmann-Lab/CroCoNet/blob/main/R/fitTreeStatsLm.R" class="external-link"><code>R/fitTreeStatsLm.R</code></a></small>
      <div class="d-none name"><code>fitTreeStatsLm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits a (weighted) linear model between the total tree length and within-species diversity (in case the focus of interest is conservation and overall divergence) or between the species-to-other branch length and the diversity of a species (in case the focus of interest is the species-specific divergence).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fitTreeStatsLm</span><span class="op">(</span><span class="va">tree_stats</span>, focus <span class="op">=</span> <span class="st">"overall"</span>, weighted_lm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tree-stats">tree_stats<a class="anchor" aria-label="anchor" href="#arg-tree-stats"></a></dt>
<dd><p>Data frame of the tree-based statistics for the pruned modules.</p>
<p>Columns required in case the focus of interest is conservation and overall divergence:</p><dl><dt>regulator</dt>
<dd><p>Character, transcriptional regulator.</p></dd>

<dt>module_size</dt>
<dd><p>Integer, the numer of target genes assigned to a regulator.</p></dd>

<dt>total_tree_length</dt>
<dd><p>Numeric, total tree length per module (typically the median across all jackknife versions of the module).</p></dd>

<dt>var_total_tree_length</dt>
<dd><p>Numeric, the variance of total tree lengths across all jackknifed versions of the module (optional, only needed for weighted regression).</p></dd>

<dt>within_species_diversity</dt>
<dd><p>Numeric, within-species diveristy per module (typically the median across all jackknife versions of the module).</p></dd>


</dl><p>Columns required in case the focus of interest is species-specific divergence:</p><dl><dt>regulator</dt>
<dd><p>Character, transcriptional regulator.</p></dd>

<dt>module_size</dt>
<dd><p>Integer, the numer of target genes assigned to a regulator.</p></dd>

<dt>{{species}}_to_other_branch_length</dt>
<dd><p>Numeric, the branch length between the species of interest and all others per module (typically the median across all jackknife versions of the module).</p></dd>

<dt>var_{{species}}_to_other_branch_length</dt>
<dd><p>Numeric, the variance of the branch length between the species of interest and all others across all jackknifed versions of the module (optional, only needed for weighted regression).</p></dd>

<dt>{{species}}_diversity</dt>
<dd><p>Numeric, within-species diveristy per module (typically the median across all jackknife versions of the module).</p></dd>


</dl></dd>


<dt id="arg-focus">focus<a class="anchor" aria-label="anchor" href="#arg-focus"></a></dt>
<dd><p>Character, the focus of interest in terms of cross-species conservation, either "overall" if the focus of interest is conservation and overall divergence, or the name of a species if the focus of interest is the divergence between that particular species and all others.</p></dd>


<dt id="arg-weighted-lm">weighted_lm<a class="anchor" aria-label="anchor" href="#arg-weighted-lm"></a></dt>
<dd><p>Logical indicating whether the linear regression should be weighted or not (default: TRUE). If TRUE, <code>tree_stats</code> is expected to contain the column <code>var_total_tree_length</code> and the weights will be inversely proportional to these variances. If no jackknifing was performed and thus these variances were not calculated, please set this parameter to FALSE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The linear models output by this function can be used to identify conserved and diverged modules, and to identify target genes within these modules that contribute the most to the conservation/divergence. For details, please see <code><a href="findConservedDivergedModules.html">findConservedDivergedModules</a></code> and <code><a href="findConservedDivergedTargets.html">findConservedDivergedTargets</a></code>.</p>
<p>The focus of interest can be specified using the parameter <code>focus</code>. If <code>focus</code> is set to "overall" (default), the linear model will be fit between the total tree length and within-species diversity, and subsequent analysis using <code><a href="findConservedDivergedModules.html">findConservedDivergedModules</a></code> and <code><a href="findConservedDivergedTargets.html">findConservedDivergedTargets</a></code> can identify modules and target genes that are conserved or diverged across all species. If <code>focus</code> is set to the name of a species in the dataset, the linear model will be fit between the species-to-other branch length and the diversity of that species, and subsequent analysis using <code><a href="findConservedDivergedModules.html">findConservedDivergedModules</a></code> and <code><a href="findConservedDivergedTargets.html">findConservedDivergedTargets</a></code> can identify modules and target genes that are diverged between the species and all others. Please note that if the aim is to find conserved modules, <code>focus</code> should always be set to "overall".</p>
<p>The function fits the linear model corresponding to the focus of interest by calling <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>. If a weighted model is desired (default), the weights are defined to be inversely proportional to the variance of the dependent variable (total tree length or the species-to-other branch length). If no jackknifing was performed and thus the variance is unknown, please set <code>weighted_lm</code> to FALSE.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">lm_overall</span> <span class="op">&lt;-</span> <span class="fu">fitTreeStatsLm</span><span class="op">(</span><span class="va">tree_stats</span>, focus <span class="op">=</span> <span class="st">"overall"</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anita Térmeg.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

