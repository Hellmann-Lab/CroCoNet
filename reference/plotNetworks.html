<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot the networks of modules — plotNetworks • CroCoNet</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot the networks of modules — plotNetworks"><meta name="description" content='In the CroCoNet approach, networks are reconstructed per replicate and combined into a single phylogeny-aware consensus network which is the basis of the module assignment.
This function selects the intramodular edges of the input module(s) in the consensus network, orders them by the consensus edge weight and keeps the top N edges per module for plotting. This means that only those module member genes will appear on the plot that are involved in the top N connections, the regulator itself might also be omitted if it is not particularly well-connected.
The edges that were kept are plotted using ggraph per module. The default layout is "kk", other reasonable options include "stress", "circle", "nicely", "dh", "graphopt", "mds", "fr", "gem" and "drl" (see also ggraph, layout_tbl_graph_stress and layout_tbl_graph_igraph). The width of the edges represents the consensus edge weights, the range of widths can be set using edge_width.
If color_by is set to "edge_divergence" (the default), for each edge an edge divergence score is calculated based on its edge weights in the networks of individual replicates. The edge weights are compared across species using an ANOVA, and the F-statistic (i.e. between-species variability / within-species variability) is regarded as the measure of edge divergence and used to color the edges on the plot. To calculate this information, network_list and replicate2species has to be provided.
If color_by is set to "direction", the edges are colored based on the direction of interaction (positively correlated/coexpressed or negatively correlated/anti-coexpressed) between the 2 genes that from the edge. This information is taken from the direction edge attribute of consensus_network.
If the aim is to plot the networks of several modules together, the input module_names should be a vector of module names. The ggraph plots are in this case combined together into a single patchwork object with the titles of the subplots matching the elements of module_names. All subplots have the same scale so that the edge weights and divergence scores (if color_by = "edge_divergence") are comparable across modules.'><meta property="og:description" content='In the CroCoNet approach, networks are reconstructed per replicate and combined into a single phylogeny-aware consensus network which is the basis of the module assignment.
This function selects the intramodular edges of the input module(s) in the consensus network, orders them by the consensus edge weight and keeps the top N edges per module for plotting. This means that only those module member genes will appear on the plot that are involved in the top N connections, the regulator itself might also be omitted if it is not particularly well-connected.
The edges that were kept are plotted using ggraph per module. The default layout is "kk", other reasonable options include "stress", "circle", "nicely", "dh", "graphopt", "mds", "fr", "gem" and "drl" (see also ggraph, layout_tbl_graph_stress and layout_tbl_graph_igraph). The width of the edges represents the consensus edge weights, the range of widths can be set using edge_width.
If color_by is set to "edge_divergence" (the default), for each edge an edge divergence score is calculated based on its edge weights in the networks of individual replicates. The edge weights are compared across species using an ANOVA, and the F-statistic (i.e. between-species variability / within-species variability) is regarded as the measure of edge divergence and used to color the edges on the plot. To calculate this information, network_list and replicate2species has to be provided.
If color_by is set to "direction", the edges are colored based on the direction of interaction (positively correlated/coexpressed or negatively correlated/anti-coexpressed) between the 2 genes that from the edge. This information is taken from the direction edge attribute of consensus_network.
If the aim is to plot the networks of several modules together, the input module_names should be a vector of module names. The ggraph plots are in this case combined together into a single patchwork object with the titles of the subplots matching the elements of module_names. All subplots have the same scale so that the edge weights and divergence scores (if color_by = "edge_divergence") are comparable across modules.'><meta property="og:image" content="https://hellmann-lab.github.io/CroCoNet/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CroCoNet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/CroCoNet.html">Tutorial</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Documentation</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Hellmann-Lab/CroCoNet/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot the networks of modules</h1>
      <small class="dont-index">Source: <a href="https://github.com/Hellmann-Lab/CroCoNet/blob/main/R/plotNetworks.R" class="external-link"><code>R/plotNetworks.R</code></a></small>
      <div class="d-none name"><code>plotNetworks.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>In the CroCoNet approach, networks are reconstructed per replicate and combined into a single phylogeny-aware consensus network which is the basis of the module assignment.</p>
<p>This function selects the intramodular edges of the input module(s) in the consensus network, orders them by the consensus edge weight and keeps the top <code>N</code> edges per module for plotting. This means that only those module member genes will appear on the plot that are involved in the top <code>N</code> connections, the regulator itself might also be omitted if it is not particularly well-connected.</p>
<p>The edges that were kept are plotted using <code>ggraph</code> per module. The default layout is "kk", other reasonable options include "stress", "circle", "nicely", "dh", "graphopt", "mds", "fr", "gem" and "drl" (see also <code>ggraph</code>, <code>layout_tbl_graph_stress</code> and <code>layout_tbl_graph_igraph</code>). The width of the edges represents the consensus edge weights, the range of widths can be set using <code>edge_width</code>.</p>
<p>If <code>color_by</code> is set to "edge_divergence" (the default), for each edge an edge divergence score is calculated based on its edge weights in the networks of individual replicates. The edge weights are compared across species using an ANOVA, and the F-statistic (i.e. between-species variability / within-species variability) is regarded as the measure of edge divergence and used to color the edges on the plot. To calculate this information, <code>network_list</code> and <code>replicate2species</code> has to be provided.</p>
<p>If <code>color_by</code> is set to "direction", the edges are colored based on the direction of interaction (positively correlated/coexpressed or negatively correlated/anti-coexpressed) between the 2 genes that from the edge. This information is taken from the <code>direction</code> edge attribute of <code>consensus_network</code>.</p>
<p>If the aim is to plot the networks of several modules together, the input <code>module_names</code> should be a vector of module names. The <code>ggraph</code> plots are in this case combined together into a single <code>patchwork</code> object with the titles of the subplots matching the elements of <code>module_names</code>. All subplots have the same scale so that the edge weights and divergence scores (if <code>color_by</code> = "edge_divergence") are comparable across modules.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotNetworks</span><span class="op">(</span></span>
<span>  <span class="va">module_names</span>,</span>
<span>  <span class="va">pruned_modules</span>,</span>
<span>  <span class="va">consensus_network</span>,</span>
<span>  network_list <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  replicate2species <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  N <span class="op">=</span> <span class="fl">300L</span>,</span>
<span>  color_by <span class="op">=</span> <span class="st">"edge_divergence"</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  layout <span class="op">=</span> <span class="st">"kk"</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  font_size <span class="op">=</span> <span class="fl">14</span>,</span>
<span>  edge_width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">1.2</span><span class="op">)</span>,</span>
<span>  ncol <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-module-names">module_names<a class="anchor" aria-label="anchor" href="#arg-module-names"></a></dt>
<dd><p>Character or character vector, the name(s) of the module(s) of interest.</p></dd>


<dt id="arg-pruned-modules">pruned_modules<a class="anchor" aria-label="anchor" href="#arg-pruned-modules"></a></dt>
<dd><p>Data frame of the pruned modules, required columns:</p><dl><dt>regulator</dt>
<dd><p>Character, transcriptional regulator.</p></dd>

<dt>target</dt>
<dd><p>Character, target gene of the transcriptional regulator (member of the regulator's pruned module).</p></dd>


</dl></dd>


<dt id="arg-consensus-network">consensus_network<a class="anchor" aria-label="anchor" href="#arg-consensus-network"></a></dt>
<dd><p><code>igraph</code> object, the consensus network across all species and replicates.</p></dd>


<dt id="arg-network-list">network_list<a class="anchor" aria-label="anchor" href="#arg-network-list"></a></dt>
<dd><p>A named list of <code>igraph</code> objects containing the networks of all replicates (only needed if <code>color_by</code> is set to "edge_divergence").</p></dd>


<dt id="arg-replicate-species">replicate2species<a class="anchor" aria-label="anchor" href="#arg-replicate-species"></a></dt>
<dd><p>A data frame that specifies which species each replicate belongs to (only needed if <code>color_by</code> is set to "edge_divergence"), required columns:</p><dl><dt>replicate</dt>
<dd><p>Character, name of the replicate.</p></dd>

<dt>species</dt>
<dd><p>Character, name of the species.</p></dd>


</dl></dd>


<dt id="arg-n">N<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Integer, the number of edges to plot (default: 300).</p></dd>


<dt id="arg-color-by">color_by<a class="anchor" aria-label="anchor" href="#arg-color-by"></a></dt>
<dd><p>Character, one of "edge_divergence" and "direction", specifies whether the edges should be colored by the degree of edge divergence across species (default) or the direction of interaction between the 2 genes that form the edge, i.e. positively or negatively correlated.</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>Integer, the number of cores (default: 1).</p></dd>


<dt id="arg-layout">layout<a class="anchor" aria-label="anchor" href="#arg-layout"></a></dt>
<dd><p>Character, graph layout (default: "kk", other reasonable options are "auto", "stress", "star", "circle", "nicely", "dh", "gem", "graphopt", "grid", "mds", "fr", "drl", "eigen", "fabric", "linear" and "unrooted"). See also <code>ggraph</code>, <code>layout_tbl_graph_stress</code> and <code>layout_tbl_graph_igraph</code>.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Integer, the seed for setting up the graph layout (default: 0, only relevant for certain layouts such as "gem", "nicely", "dh", "graphopt", "fr" and "drl").</p></dd>


<dt id="arg-colors">colors<a class="anchor" aria-label="anchor" href="#arg-colors"></a></dt>
<dd><p>Character vector, the colors to visualize the edge directions or edge divergences. If <code>color_by</code> is set to "edge_divergence", the vector can contain any number of colors that will be passed on to and converted into a continuous scale by <code>scale_color_gradientn</code>. If <code>color_by</code> is set to "direction", the vector should contain 2 colors for the positively and negatively correlated gene pairs.</p></dd>


<dt id="arg-font-size">font_size<a class="anchor" aria-label="anchor" href="#arg-font-size"></a></dt>
<dd><p>Numeric, font size (default: 14).</p></dd>


<dt id="arg-edge-width">edge_width<a class="anchor" aria-label="anchor" href="#arg-edge-width"></a></dt>
<dd><p>Numeric vector of length 2, the range of edge widths for plotting the graph edges (default: c(0.2, 1.2)).</p></dd>


<dt id="arg-ncol">ncol<a class="anchor" aria-label="anchor" href="#arg-ncol"></a></dt>
<dd><p>Integer, the number of columns the subplots should be organized into if several modules are input. If NULL (default), the dimensions of the grid will follow the default of <code>wrap_plots</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>ggraph</code> object in case <code>module_names</code> is a single module name and a <code>patchwork</code> object in case <code>module_names</code> is a vector of module names.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Plots the top <code>N</code> strongest connections of the chosen module(s) based on the consensus network. The edge width indicates the consensus edge weights, while the edge color indicates either the degree of edge divergence across species or the direction of interaction between the 2 genes that form the edge (positively/negatively correlated).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">plotNetworks</span><span class="op">(</span><span class="st">"POU5F1"</span>, <span class="va">pruned_modules</span>, <span class="va">consensus_network</span>, <span class="va">network_list</span>, <span class="va">replicate2species</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring unknown parameters: `label.size`</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring unknown parameters: `label.size`</span>
<span class="r-plt img"><img src="plotNetworks-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anita Térmeg.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

