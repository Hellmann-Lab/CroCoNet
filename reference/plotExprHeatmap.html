<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot expression profiles as a heatmap — plotExprHeatmap • CroCoNet</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot expression profiles as a heatmap — plotExprHeatmap"><meta name="description" content="Plots the expression profiles of one or more genes as a heatmap, with the cells ordered by pseudotime or cell type."><meta property="og:description" content="Plots the expression profiles of one or more genes as a heatmap, with the cells ordered by pseudotime or cell type."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CroCoNet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/CroCoNet.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Hellmann-Lab/CroCoNet/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot expression profiles as a heatmap</h1>
      <small class="dont-index">Source: <a href="https://github.com/Hellmann-Lab/CroCoNet/blob/main/R/plotExpr.R" class="external-link"><code>R/plotExpr.R</code></a></small>
      <div class="d-none name"><code>plotExprHeatmap.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plots the expression profiles of one or more genes as a heatmap, with the cells ordered by pseudotime or cell type.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotExprHeatmap</span><span class="op">(</span></span>
<span>  <span class="va">genes</span>,</span>
<span>  <span class="va">sce</span>,</span>
<span>  order_by <span class="op">=</span> <span class="st">"pseudotime"</span>,</span>
<span>  heatmap_colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annotation_colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  z_transform <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  clip <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">z_transform</span>, <span class="fl">3</span>, <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>  font_size <span class="op">=</span> <span class="fl">14</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-genes">genes<a class="anchor" aria-label="anchor" href="#arg-genes"></a></dt>
<dd><p>Character vector, the names of the genes for which the expression profiles should be plotted.</p></dd>


<dt id="arg-sce">sce<a class="anchor" aria-label="anchor" href="#arg-sce"></a></dt>
<dd><p><code>SingleCellExperiment</code> object containing the expression data (logcounts and metadata) for all network genes. Required metadata column:</p><dl><dt>{{order_by}}</dt>
<dd><p>Numeric or character, the column by which the cells should be ordered on the plot. Typically contains the inferred pseudotime, or the cell type labels.</p></dd>


</dl></dd>


<dt id="arg-order-by">order_by<a class="anchor" aria-label="anchor" href="#arg-order-by"></a></dt>
<dd><p>Character specifying the column in the metadata of <code>sce</code> by which the cells should be ordered on the plot. This column typically contains the inferred pseudotime (default: "pseudotime"), or the cell type labels.</p></dd>


<dt id="arg-heatmap-colors">heatmap_colors<a class="anchor" aria-label="anchor" href="#arg-heatmap-colors"></a></dt>
<dd><p>Character vector, the heatmap colors for the expression levels. The vector can contain any number of colors that will be passed on to and converted into a continuous scale by <code>scale_color_gradientn</code>.</p></dd>


<dt id="arg-annotation-colors">annotation_colors<a class="anchor" aria-label="anchor" href="#arg-annotation-colors"></a></dt>
<dd><p>Character vector, the colors for the variable specified by <code>order_by</code>. If the variable is discrete, the vector should contain as many colors as there are unique values of the variable, if the variable is continuous, the vector can contain any number of colors that will be passed on to and converted into a continuous scale by <code>scale_color_gradientn</code></p></dd>


<dt id="arg-z-transform">z_transform<a class="anchor" aria-label="anchor" href="#arg-z-transform"></a></dt>
<dd><p>Logical specifying whether z-transformation should be performed per gene before plotting (default: TRUE).</p></dd>


<dt id="arg-clip">clip<a class="anchor" aria-label="anchor" href="#arg-clip"></a></dt>
<dd><p>Numeric specifying the degree of clipping. For each gene, the expression level values that are more standard deviations away from the mean than <code>clip</code> are treated as NA. If <code>z_transform</code> is set to TRUE, the default is 3 meaning that expression levels are clipped to the range of mean \(\pm\) 3\(\sigma\) per gene, otherwise the default is Inf.</p></dd>


<dt id="arg-font-size">font_size<a class="anchor" aria-label="anchor" href="#arg-font-size"></a></dt>
<dd><p>Numeric, font size (default: 14).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A heatmap as a <code>ggplot</code> object showing the expression profiles of the input genes across all cells.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function creates a heatmap, with columns corresponding to cells, rows corresponding to genes and colors corresponding to scaled and centered expression levels.</p>
<p>The expression data are taken from the logcounts assay of the input <code>sce</code> object. The colors to represent the expression levels can be controlled by the parameter <code>heatmap_colors</code>.</p>
<p>The cells can be order by pseudotime, cell type or any other variable that makes sense in the given context. The name of metadata column in the input <code>sce</code> object containing the desired cell property can be specified by the parameter <code>order_by</code> (default: "pseudotime"). This cell property is visualized as a rug plot under the heatmap, the colors for the rug can be controlled by the parameter <code>annotation_colors</code>.</p>
<p>Expression levels are clipped to the range of mean \(\pm\) 3\(\sigma\) per gene, this can be changed via the parameter <code>clip</code>. Clipping aids visualization by preventing the outlier data points from squishing the rest of the data into a small color range. If clipping is not desired, please set <code>clip</code> to Inf.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other functions to plot gene expression profiles:
<code><a href="plotExprAlongPseudotime.html">plotExprAlongPseudotime</a>()</code>,
<code><a href="plotExprViolin.html">plotExprViolin</a>()</code>,
<code><a href="plotSumExprHeatmap.html">plotSumExprHeatmap</a>()</code>,
<code><a href="plotSumExprLine.html">plotSumExprLine</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">plotExprHeatmap</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"POU5F1"</span>,<span class="st">"DNMT3B"</span>,<span class="st">"TERF1"</span>,<span class="st">"TDGF1"</span>,<span class="st">"L1TD1"</span>,<span class="st">"VIM"</span>,<span class="st">"MAP1B"</span>,<span class="st">"MARCKS"</span>,<span class="st">"PTN"</span>,<span class="st">"CDH2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                <span class="va">sce</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotExprHeatmap-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anita Térmeg.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

