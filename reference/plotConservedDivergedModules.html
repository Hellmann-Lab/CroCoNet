<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot module conservation — plotConservedDivergedModules • CroCoNet</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot module conservation — plotConservedDivergedModules"><meta name="description" content="Plots the tree-bases statistics that characterize the cross-species conservation of the modules and marks the modules that were found to be conserved/diverged."><meta property="og:description" content="Plots the tree-bases statistics that characterize the cross-species conservation of the modules and marks the modules that were found to be conserved/diverged."><meta property="og:image" content="https://hellmann-lab.github.io/CroCoNet/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CroCoNet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/CroCoNet.html">Tutorial</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Documentation</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Hellmann-Lab/CroCoNet/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot module conservation</h1>
      <small class="dont-index">Source: <a href="https://github.com/Hellmann-Lab/CroCoNet/blob/main/R/plotConservedDivergedModules.R" class="external-link"><code>R/plotConservedDivergedModules.R</code></a></small>
      <div class="d-none name"><code>plotConservedDivergedModules.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plots the tree-bases statistics that characterize the cross-species conservation of the modules and marks the modules that were found to be conserved/diverged.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotConservedDivergedModules</span><span class="op">(</span></span>
<span>  <span class="va">module_conservation</span>,</span>
<span>  N <span class="op">=</span> <span class="fl">5L</span>,</span>
<span>  rank_by <span class="op">=</span> <span class="st">"residual"</span>,</span>
<span>  colors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  font_size <span class="op">=</span> <span class="fl">14</span>,</span>
<span>  label_size <span class="op">=</span> <span class="fl">3.5</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-module-conservation">module_conservation<a class="anchor" aria-label="anchor" href="#arg-module-conservation"></a></dt>
<dd><p>Data frame of cross-species conservation measures per module.</p>
<p>Columns required in case the focus of interest is conservation and overall divergence:</p><dl><dt>focus</dt>
<dd><p>Character, the focus of interest in terms of cross-species conservation, "overall" if the focus of interest is conservation and overall divergence.</p></dd>

<dt>regulator</dt>
<dd><p>Character, transcriptional regulator.</p></dd>

<dt>total_tree_length</dt>
<dd><p>Numeric, total tree length per module (typically the median across all jackknife versions of the module).</p></dd>

<dt>lwr_total_tree_length</dt>
<dd><p>Numeric, the lower bound of the confidence interval of the total tree length calculated based on the jackknifed versions of the module (optional, only needed for plotting error bars later on).</p></dd>

<dt>upr_total_tree_length</dt>
<dd><p>Numeric, the upper bound of the confidence interval of the total tree length calculated based on the jackknifed versions of the module (optional, only needed for plotting error bars later on).</p></dd>

<dt>within_species_diversity</dt>
<dd><p>Numeric, within-species diveristy per module (typically the median across all jackknife versions of the module).</p></dd>

<dt>lwr_within_species_diversity</dt>
<dd><p>Numeric, the lower bound of the confidence interval of the within-species diversity calculated based on the jackknifed versions of the module (optional, only needed for plotting error bars later on).</p></dd>

<dt>upr_within_species_diversity</dt>
<dd><p>Numeric, the upper bound of the confidence interval of the within-species diversity calculated based on the jackknifed versions of the module (optional, only needed for plotting error bars later on).</p></dd>

<dt>fit</dt>
<dd><p>Numeric, the fitted total tree length at the within-species diversity value of the module.</p></dd>

<dt>lwr_fit</dt>
<dd><p>Numeric, the lower bound of the prediction interval of the fit.</p></dd>

<dt>upr_fit</dt>
<dd><p>Numeric, the upper bound of the prediction interval of the fit.</p></dd>

<dt>residual</dt>
<dd><p>Numeric, the residual of the module in the linear model. It is calculated as the difference between the observed and expected (fitted) total tree lengths.</p></dd>

<dt>t_score</dt>
<dd><p>Numeric, the t-score of the module. It is calculated as the residual normalized by the standard error of the total tree length prediction at the given within-species diversity value</p></dd>

<dt>conservation</dt>
<dd><p>Character, "not_significant" if the module falls inside the prediction interval of the fit, "diverged" if a module has a higher total tree length than the upper boundary of the prediction interval, and "conserved" if a module has a lower total tree length than the lower boundary of the prediction interval</p></dd>


</dl><p>Columns required in case the focus of interest is species-specific divergence:</p><dl><dt>focus</dt>
<dd><p>Character, the focus of interest in terms of cross-species conservation, the name of a species if the focus of interest is species-specific divergence</p></dd>

<dt>regulator</dt>
<dd><p>Character, transcriptional regulator.</p></dd>

<dt>{{species}}_subtree_length</dt>
<dd><p>Numeric, the subtree length of the species per module (typically the median across all jackknife versions of the module).</p></dd>

<dt>lwr_{{species}}_subtree_length</dt>
<dd><p>Numeric, the lower bound of the confidence interval of the species subtree length calculated based on the jackknifed versions of the module (optional, only needed for plotting error bars later on).</p></dd>

<dt>upr_{{species}}_subtree_length</dt>
<dd><p>Numeric, the upper bound of the confidence interval of the species subtree length calculated based on the jackknifed versions of the module (optional, only needed for plotting error bars later on).</p></dd>

<dt>{{species}}_diversity</dt>
<dd><p>Numeric, the diveristy of the species of interest per module (typically the median across all jackknife versions of the module).</p></dd>

<dt>lwr_{{species}}_diversity</dt>
<dd><p>Numeric, the lower bound of the confidence interval of the species-specific diversity calculated based on the jackknifed versions of the module (optional, only needed for plotting error bars later on).</p></dd>

<dt>upr_{{species}}_diversity</dt>
<dd><p>Numeric, the upper bound of the confidence interval of the species-specific diversity calculated based on the jackknifed versions of the module (optional, only needed for plotting error bars later on).</p></dd>

<dt>fit</dt>
<dd><p>Numeric, the fitted subtree length of a species.</p></dd>

<dt>lwr_fit</dt>
<dd><p>Numeric, the lower bound of the prediction interval of the fit.</p></dd>

<dt>upr_fit</dt>
<dd><p>Numeric, the upper bound of the prediction interval of the fit.</p></dd>

<dt>residual</dt>
<dd><p>Numeric, the residual of the module in the linear model. It is calculated as the difference between the observed and expected (fitted) subtree length of a species.</p></dd>

<dt>t_score</dt>
<dd><p>Numeric, the t-score of the module. It is calculated as the residual normalized by the standard error of the species subtree length prediction.</p></dd>

<dt>conservation</dt>
<dd><p>Character, 'not_significant' if the module falls inside the prediction interval of the fit, 'diverged' if a module has a higher species subtree length than the upper boundary of the prediction interval, and 'conserved' if a module has a lower species subtree length than the lower boundary of the prediction interval.</p></dd>


</dl></dd>


<dt id="arg-n">N<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Integer, the number of top conserved and diverged modules to label.</p></dd>


<dt id="arg-rank-by">rank_by<a class="anchor" aria-label="anchor" href="#arg-rank-by"></a></dt>
<dd><p>Character, one of "residual" and "t_score". The name of the variable to rank the by when selecting the top N conserved and diverged modules to label.</p></dd>


<dt id="arg-colors">colors<a class="anchor" aria-label="anchor" href="#arg-colors"></a></dt>
<dd><p>(Named) character vector of length 2, the colors for the diverged and conserved modules.</p></dd>


<dt id="arg-font-size">font_size<a class="anchor" aria-label="anchor" href="#arg-font-size"></a></dt>
<dd><p>Numeric, font size (default: 14).</p></dd>


<dt id="arg-label-size">label_size<a class="anchor" aria-label="anchor" href="#arg-label-size"></a></dt>
<dd><p>Numeric, the size of the labels for the most conserved and diverged modules (default: 3.5).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>ggplot</code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>To determine whether a module as whole is conserved, diverged overall or diverged on a specific lineage, the CroCoNet approach relies on module trees reconstructed from pairwise preservation scores between replicates and statistics calculated based on these trees (total tree length, subtree lengths of the species, overall within-species and species-specific diversity, for details please see <code><a href="calculatePresStats.html">calculatePresStats</a></code>, <code><a href="reconstructTrees.html">reconstructTrees</a></code>, <code><a href="calculateTreeStats.html">calculateTreeStats</a></code> and <code><a href="findConservedDivergedModules.html">findConservedDivergedModules</a></code>).</p>
<p>The function plots each input module along the regression line that captures the relationship between total tree length and within-species diversity (in case the focus of interest is conservation and overall divergence) or between the subtree length and diversity of a species (in case the focus of interest is divergence between this particular species and all others). A module is considered diverged overall/in a species-specific manner if it falls above the prediction interval of the regression line, while a module is considered conserved if it falls below the prediction interval of the regression line.</p>
<p>The regression line is drawn in dark grey, and the 95% prediction interval of the line is shown as a light grey area. If the focus of interest is conservation and overall divergence, the conserved modules are colored green, the diverged modules are colored red, and the top 'N' conserved and diverged modules based on the variable specified in <code>rank_by</code> are labelled. If the focus of interest is divergence between a particular species and all others, only the diverged modules are colored and labelled, the modules below the prediction interval are not meaningful and thus not highlighted. If confidence intervals are provided for the variables, each module is plotted with error bars.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">plotConservedDivergedModules</span><span class="op">(</span><span class="va">module_conservation_overall</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotConservedDivergedModules-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anita Térmeg.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

